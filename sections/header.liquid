<link rel="preload" href="{{ 'header.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ 'mega-menu.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
<link rel="preload" href="{{ 'buttons.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">

{%- assign search_placeholder       = section.settings.search_placeholder -%}
{%- assign hide_top_bar             = section.settings.hide_top_bar -%}
{%- assign top_bar_image            = section.settings.top_bar_image -%}
{%- assign top_bar_text             = section.settings.top_bar_text -%}
{%- assign top_bar_phone            = section.settings.top_bar_phone -%}
{%- assign top_bar_message          = section.settings.top_bar_message -%}
{%- assign top_bar_menu             = section.settings.top_bar_menu -%}
{%- assign top_bar_background 		= section.settings.top_bar_background -%}
{%- assign top_bar_foreground 		= section.settings.top_bar_foreground -%}
{%- assign logo                     = section.settings.logo -%}
{%- assign custom_title 			= section.settings.custom_title -%}
{%- assign menu 					= section.settings.menu -%}
{%- assign menu_position 			= section.settings.menu_position -%}
{%- assign menu_position_mobile 	= section.settings.menu_position_mobile -%}
{%- assign header_background 		= section.settings.header_background -%}
{%- assign header_foreground 		= section.settings.header_foreground -%}
{%- assign padding_top 				= section.settings.padding_top -%}
{%- assign padding_bottom 			= section.settings.padding_bottom -%}
{%- assign padding_top_mobile 		= section.settings.padding_top_mobile -%}
{%- assign padding_bottom_mobile 	= section.settings.padding_bottom_mobile -%}
{%- assign sticky_header 			= section.settings.sticky_header -%}

{%- capture variables -%}
    --color-top-bar-background: {{ top_bar_background }};
    --color-top-bar-foreground: {{ top_bar_foreground }};
    --color-header-background: {{ header_background }};
    --color-header-foreground: {{ header_foreground }};
    --padding-top: {{ padding_top }}px;
    --padding-bottom: {{ padding_bottom }}px;
    --padding-top-mobile: {{ padding_top_mobile }}px;
    --padding-bottom-mobile: {{ padding_bottom_mobile }}px;

    {%- case menu_position -%}
        {%- when 'left' -%}
            --justify-content: flex-start;
		{%- when 'left-center' -%}
			--justify-content: center;
		{%- when 'left-right' -%}
			--justify-content: flex-end;
        {%- when 'left-below' -%}
            --justify-content: flex-start;
        {%- when 'center-left' -%}
            --justify-content: flex-start;
	{%- endcase -%}

	{%- case menu_position_mobile -%}
        {%- when 'left' -%}
            --translate: translateX(-100%);
		{%- when 'right' -%}
			--translate: translateX(100%);
	{%- endcase -%}
{%- endcapture -%}

{%- capture svg_sprite -%}
	<svg display="none">
		<defs>
			<g id="img-frame-256">
				<path xmlns="http://www.w3.org/2000/svg" fill="#0B1A26" d="M15.3333 18.0002C14.2309 17.9992 13.1455 17.7267 12.1733 17.2069L11.8733 17.0402C9.8005 15.9257 8.10113 14.2263 6.98667 12.1535L6.82 11.8535C6.28655 10.8758 6.00475 9.78064 6 8.66684V8.22018C5.99972 7.86482 6.14131 7.52404 6.39333 7.27351L7.52 6.14684C7.62942 6.03658 7.78387 5.98343 7.93797 6.00302C8.09207 6.02261 8.22832 6.11271 8.30667 6.24685L9.80667 8.82018C9.95835 9.0821 9.91455 9.41335 9.7 9.62684L8.44 10.8869C8.33536 10.9903 8.31098 11.1502 8.38 11.2802L8.61333 11.7202C9.45136 13.2725 10.7262 14.545 12.28 15.3802L12.72 15.6202C12.85 15.6892 13.0099 15.6648 13.1133 15.5602L14.3733 14.3002C14.5868 14.0857 14.9181 14.0419 15.18 14.1935L17.7533 15.6935C17.8875 15.7719 17.9776 15.9081 17.9971 16.0622C18.0167 16.2163 17.9636 16.3708 17.8533 16.4802L16.7267 17.6069C16.4761 17.8589 16.1353 18.0005 15.78 18.0002H15.3333Z"/>
			</g>
		</defs>
	</svg>
{%- endcapture -%}


{%- if hide_top_bar != true -%}
    {%- capture anoncement_bar -%}
        <div class="header__anoncement-bar anoncement-bar">
			<div class="anoncement-bar__container container">
				<div class="anoncement-bar__info">
					{{top_bar_image}}
					{%- if top_bar_image != blank -%}
						<img
							src="{{ top_bar_image | image_url }}"
							alt="{{- top_bar_image.alt -}}"
							class="anoncement-bar__icon"
						>
					{%- else -%}
						<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" version="1.1">
							<use xlink:href="#img-frame-256"></use>
						</svg>
					{%- endif -%}

					{%- if top_bar_text != blank -%}
						<span class="anoncement-bar__text">
							{{- top_bar_text -}}
						</span>
					{%- endif -%}

					{%- if top_bar_phone != blank -%}
						<span class="anoncement-bar__phone">
							<a href="tel:{{ top_bar_phone | remove: '+' | remove: ' ' }}" class="anoncement-bar__phone-link">
								{{- top_bar_phone -}}
							</a>
						</span>
					{%- endif -%}
				</div>

				<span class="anoncement-bar__text">
					{%- if top_bar_message != blank -%}
						{{- top_bar_message -}}
					{%- endif -%}
				</span>

				<nav class="anoncement-bar__menu">
					{%- if top_bar_menu != blank -%}
						<ul class="anoncement-bar__menu-list">
							{%- for link in top_bar_menu.items -%}
								{%- if link != blank -%}
									<li class="anoncement-bar__menu-item">
										<a href="{{ link.url }}" class="anoncement-bar__menu-link">
											{{- link.title -}}
										</a>
									</li>
								{%- endif -%}
							{%- endfor -%}
						</ul>
					{%- endif -%}
				</nav>
			</div>
        </div>
    {%- endcapture -%}
{%- endif -%}

{%- if menu != blank -%}
	{%- capture header_menu -%}
		<div class="header__nav-wrapper">
			<input type="checkbox" id="mobile-menu-trigger">
			<label for="mobile-menu-trigger" class="menu__opener">
				<span></span>
			</label>

			<nav class="header__nav menu">
				<ul class="header__nav-list menu__list">
					{%- for link in menu.items -%}
						{%- assign link_index = forloop.index -%}

						{%- if link != blank -%}
							<li class="menu__item">
								<a href="{{ link.url }}" class="menu__link">
									{{- link.title -}}
								</a>

								{%- if link.items_count > 0 -%}
									<input type="checkbox" id="dropdown-menu-trigger-{{- link_index -}}">
									<label for="dropdown-menu-trigger-{{- link_index -}}" class="menu__dropdown-opener">
										<i class="fa-regular fa-chevron-down menu__item-icon"></i>
									</label>
								{%- endif -%}

								{%- if link.items_count > 0 -%}
									<div class="menu__dropdown">
										<label for="dropdown-menu-trigger-{{- link_index -}}" class="menu__dropdown-opener">
											<i class="fa-regular fa-chevron-down menu__item-icon"></i>
											Back
										</label>

										<ul class="menu__dropdown-list">
											{%- for childlink in link.items -%}
												{%- assign childlink_index = forloop.index -%}

												{%- if childlink != blank -%}
													<li class="menu__dropdown-item">
														<a href="{{ childlink.url }}" class="menu__dropdown-link">
															{{- childlink.title -}}
														</a>

														{%- if childlink.items_count > 0 -%}
															<input type="checkbox" id="dropdown-childmenu-trigger-{{- childlink_index -}}">
															<label for="dropdown-childmenu-trigger-{{- childlink_index -}}" class="menu__dropdown-opener">
																<i class="fa-regular fa-chevron-down menu__item-icon"></i>
															</label>
														{%- endif -%}

														{%- if childlink.items_count > 0 -%}
															<div class="menu__dropdown">
																<label for="dropdown-childmenu-trigger-{{- childlink_index -}}" class="menu__dropdown-opener">
																	<i class="fa-regular fa-chevron-down menu__item-icon"></i>
																	Back
																</label>

																<ul class="menu__dropdown-list">
																	{%- for grandchildlink in childlink.items -%}
																		{%- if grandchildlink != blank -%}
																			<li class="menu__dropdown-item">
																				<a href="{{ grandchildlink.url }}" class="menu__dropdown-link">
																					{{- grandchildlink.title -}}
																				</a>
																			</li>
																		{%- endif -%}
																	{%- endfor -%}
																</ul>
															</div>
														{%- endif -%}
													</li>
												{%- endif -%}
											{%- endfor -%}
										</ul>
									</div>
								{%- endif -%}
							</li>
						{%- endif -%}
					{%- endfor -%}
				</ul>
			</nav>
		</div>
	{%- endcapture -%}
{%- endif -%}

{%- capture header_logo -%}
	<div class="header__logo-wrapper">
		<a href="{{ routes.root_url }}" class="header__logo">
			{%- if logo != blank -%}
				<img
					src="{{ logo | image_url }}"
					alt="{{ shop.name }}"
					class="header__logo-image"
				>
			{%- elsif custom_title != blank -%}
				<h1 class="header__logo-text">
					{{- custom_title -}}
				</h1>
			{%- elsif shop.logo_url != blank -%}
				<img
					src="{{ shop.logo_url }}"
					alt="{{ shop.name }}"
					class="header__logo-image"
				>
			{%- else -%}
				<h1 class="header__logo-text">
					{{- shop.name -}}
				</h1>
			{%- endif -%}
		</a>
	</div>
{%- endcapture -%}

{%- capture header_search -%}
	<div class="header__search">
		<input type="checkbox" id="floating-search">
		<label for="floating-search" class="header__search-trigger">
			<i class="fa-light fa-magnifying-glass header__search-icon open"></i>
		</label>

		<div class="header__search-wrapper">
			<form id="search" action="{{ routes.search_url }}" role="search">
				<div class="header__search-input-wrapper">
					<i class="fa-light fa-magnifying-glass header__search-icon"></i>
					<input type="search" name="q" class="header__search-input" placeholder="{{- search_placeholder -}}">
				</div>
				<label class="header__search-trigger" for="floating-search">
					<i class="fa-light fa-xmark header__search-icon close"></i>
				</label>
			</form>
		</div>
	</div>
{%- endcapture -%}

{%- capture header_login -%}
	<div class="header__login">
		<button class="button">Log in</button>
		<button class="button button--primary button--small">Sign up</button>
	</div>
{%- endcapture -%}

{%- capture header_links -%}
	<div class="header__links">
		{{- header_search -}}

		{{- header_login -}}

		<div class="header__cart">
			{{- cart_button -}}

			<i class="fa-regular fa-spinner-third fa-spin"></i>
		</div>
	</div>
{%- endcapture -%}

{{- svg_sprite -}}

<div class="header__wrapper{% if menu_position == 'center-left' %} header-logo-centered{%- endif -%}{% if menu_position == 'left-below' %} header-menu-bottom{%- endif -%}" style="{{- variables | escape -}}">

	{{- anoncement_bar -}}

	<div class="header__content{% if padding_top != 0 or padding_top_mobile != 0 %} header__content--padding-top{% endif %}{% if padding_bottom != 0 or padding_bottom_mobile != 0 %} header__content--padding-bottom{%- endif -%}">
		<div class="header__container container">
			<div class="header__content-inner">

				{{- header_logo -}}

				{{- header_menu -}}

				{{- header_links -}}

			</div>
		</div>
	</div>
</div>

<script>
  	{%- if sticky_header -%}
		document.querySelector('.header').classList.add('header-sticky')
	{%- endif -%}
</script>

{% schema %}
    {
        "name": "Header",
        "tag": "header",
        "class": "header",
        "templates": [],
        "settings": [
            {
                "type": "header",
                "content": "Translations"
            },
            {
                "type": "text",
                "id": "search_placeholder",
                "label": "Search placeholder",
                "default": "Search"
            },
            {
                "type": "header",
                "content": "Announcement bar"
            },
            {
                "type": "checkbox",
                "id": "hide_top_bar",
                "default": false,
                "label": "Hide bar"
            },
            {
                "type": "image_picker",
                "id": "top_bar_image",
                "label": "Image"
            },
            {
                "type": "text",
                "id": "top_bar_text",
                "label": "Text",
                "default": "Call Us 24/7"
            },
            {
                "type": "text",
                "id": "top_bar_phone",
                "label": "Phone number",
                "default": "+1 755 302 8549",
                "info": "This field accepts only numbers, sign '+' and spaces"
            },
            {
                "type": "contentEditor",
                "id": "top_bar_message",
                "label": "Message",
                "default": "Free shipping from €50"
            },
            {
                "type": "menu",
                "id": "top_bar_menu",
                "label": "Anoncement menu",
                "info": "Use menus with one or couple of links max"
            },
            {
                "type": "color",
                "id": "top_bar_background",
                "label": "Background color",
				"default": "#F4B841"
            },
            {
                "type": "color",
                "id": "top_bar_foreground",
                "label": "Foreground color",
				"default": "#0B1A26"
            },
            {
                "type": "header",
                "content": "Header"
            },
			{
                "type": "checkbox",
                "id": "sticky_header",
                "default": true,
                "label": "Sticky header"
            },
            {
                "type": "image_picker",
                "id": "logo",
                "label": "Logo"
            },
            {
                "type": "text",
                "id": "custom_title",
                "label": "Custom title",
                "description": "Note: Header logo always overrides this title"
            },
			{
                "type": "color",
                "id": "header_background",
                "label": "Background color",
                "default": "#0E1B2A"
            },
            {
                "type": "color",
                "id": "header_foreground",
                "label": "Foreground color",
                "default": "#FFFFFF"
            },
            {
                "type": "menu",
                "id": "menu",
                "label": "Mega menu"
            },
			{
                "type": "header",
                "content": "Desktop settings"
            },
            {
                "type": "select",
                "id": "menu_position",
                "label": "Menu position",
                "options": [
                    {
                        "value": "left",
                        "label": "Logo left / Menu left"
                    },
                    {
                        "value": "left-center",
                        "label": "Logo left / Menu center"
                    },
                    {
                        "value": "left-right",
                        "label": "Logo left / Menu right"
                    },
                    {
                        "value": "left-below",
                        "label": "Logo left / Menu below"
                    },
                    {
                        "value": "center-left",
                        "label": "Logo center / Menu left"
                    }
                ],
                "default": "left-center"
            },
            {
                "type": "number",
                "id": "padding_top",
                "label": "Padding top",
				"default": "16",
                "info": "Use positive numbers only"
            },
            {
                "type": "number",
                "id": "padding_bottom",
                "label": "Padding bottom",
				"default": "16",
                "info": "Use positive numbers only"
            },
            {
                "type": "header",
                "content": "Mobile settings"
            },
			{
                "type": "select",
                "id": "menu_position_mobile",
                "label": "Menu appearance",
                "options": [
                    {
                        "value": "left",
                        "label": "From left"
                    },
                    {
                        "value": "right",
                        "label": "From right"
                    }
                ],
                "default": "left"
            },
            {
                "type": "number",
                "id": "padding_top_mobile",
                "label": "Padding top",
				"default": "16",
                "info": "Use positive numbers only"
            },
            {
                "type": "number",
                "id": "padding_bottom_mobile",
                "label": "Padding bottom",
				"default": "16",
                "info": "Use positive numbers only"
            }
        ]
    }
{% endschema %}
