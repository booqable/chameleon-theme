{{ "product-page.css" | asset_url | stylesheet_tag }}
{{ "accordion.css" | asset_url | stylesheet_tag }}

{%- assign title                 = product.name -%}
{%- assign description           = product.description -%}
{%- assign variation_label       = section.settings.variation_label -%}
{%- assign message_label         = section.settings.message_label -%}
{%- assign timer                 = section.settings.timer -%}
{%- assign behavior              = section.settings.behavior -%}
{%- assign color_palette         = section.settings.color_palette -%}
{%- assign color_overlay         = section.settings.color_overlay -%}
{%- assign padding_top           = section.settings.padding_top -%}
{%- assign padding_bottom        = section.settings.padding_bottom -%}
{%- assign padding_top_mobile    = section.settings.padding_top_mobile -%}
{%- assign padding_bottom_mobile = section.settings.padding_bottom_mobile -%}
{%- assign show_breadcrumbs      = section.settings.show_breadcrumbs -%}
{%- assign breadcrumbs_label     = section.settings.breadcrumbs_label -%}
{%- assign blocks                = section.blocks -%}
{%- assign is_focal              = settings.use_focal_images -%}

{%- assign carousel   = false -%}

{%- if product.images.size > 1 -%}
  {{ "carousel.css" | asset_url | stylesheet_tag }}

  {%- assign carousel = true -%}
{%- endif -%}

{%- case breadcrumbs_label -%}
  {%- when 'home' -%}
    {%- assign label = "Home" -%}
    {%- assign url   = routes.root_url -%}
  {%- when 'collections' -%}
    {%- assign label = "Categories" -%}
    {%- assign url   = routes.collections_url -%}
  {%- when 'products' -%}
    {%- assign label = "Shop all" -%}
    {%- assign url   = routes.all_products_collection_url -%}
{%- endcase -%}

{% comment %} CSS variables start {% endcomment %}
{%- capture variables -%}
  {%- if carousel -%}
    --slide-width: 100%;
    --slide-width-mobile: 100%;
  {%- endif -%}

  {%- case padding_top -%}
    {%- when 'none' -%}
      --padding-top: 0;
    {%- when 'small' -%}
      --padding-top: 24px;
    {%- when 'medium' -%}
      --padding-top: 36px;
    {%- when 'large' -%}
      --padding-top: 48px;
  {%- endcase -%}

  {%- case padding_bottom -%}
    {%- when 'none' -%}
      --padding-bottom: 0;
    {%- when 'small' -%}
      --padding-bottom: 24px;
    {%- when 'medium' -%}
      --padding-bottom: 36px;
    {%- when 'large' -%}
      --padding-bottom: 48px;
  {%- endcase -%}

  {%- case padding_top_mobile -%}
    {%- when 'none' -%}
      --padding-top-mobile: 0;
    {%- when 'small' -%}
      --padding-top-mobile: 24px;
    {%- when 'medium' -%}
      --padding-top-mobile: 36px;
    {%- when 'large' -%}
      --padding-top-mobile: 48px;
  {%- endcase -%}

  {%- case padding_bottom_mobile -%}
    {%- when 'none' -%}
      --padding-bottom-mobile: 0;
    {%- when 'small' -%}
      --padding-bottom-mobile: 24px;
    {%- when 'medium' -%}
      --padding-bottom-mobile: 36px;
    {%- when 'large' -%}
      --padding-bottom-mobile: 48px;
  {%- endcase -%}
{%- endcapture -%}
{% comment %} CSS variables end {% endcomment %}

<div class="product-main__holder{% if color_palette != blank %} palette-{{ color_palette }}{% endif %}{% if color_overlay != blank %} overlay-{{- color_overlay -}}{%- endif -%}" style="{{- variables | escape -}}">
  <div class="product-main__container container {% if padding_top != blank or padding_top_mobile != blank %} product-main__container--padding-top{% endif %}{% if padding_bottom != blank or padding_bottom_mobile != blank %} product-main__container--padding-bottom{%- endif -%}">
    {%- render 'breadcrumbs',
      product: product,
      show: show_breadcrumbs,
      label: label,
      url: url
    -%}

    <div class="product-main__wrapper{% if carousel %} product-main__wrapper-with-carousel{%- endif -%}">
      <div class="product-main__gallery">
        {%- if carousel -%}
          <div class="carousel carousel__slide-effect carousel__pause" aria-label="Gallery">
            <input class="carousel__timer" type="hidden" name="hidden" value="{{- timer -}}">
            <div class="carousel__wrapper">
        {%- endif -%}
              {%- for image in product.images -%}
                {%- assign index = forloop.index -%}

                {%- if carousel -%}
                  <div class="carousel__item">
                    <div class="carousel__inner">
                {%- endif -%}
                      <input type="checkbox" name="popup" id="popup-{{- index -}}" style="display: none;" />
                      <label class="product-main__modal-opener" for="popup-{{- index -}}">
                        {%- render 'image',
                          image: image,
                          loading: 'lazy',
                          class: 'product-main__gallery-image',
                          size: 'l'
                        -%}
                        <span class="product-main__zoom-in" style="display: none;">
                          {%- render 'icon-zoom-in' -%}
                        </span>
                      </label>

                      <div id="popup-{{- index -}}" class="product-main__modal" style="display: none;">
                        <label class="product-main__modal-close" for="popup-{{- index -}}"></label>
                        <div class="product-main__popup">
                          <label class="product-main__modal-close" for="popup-{{- index -}}">&times;</label>
                          {%- render 'image',
                            image: image,
                            loading: 'lazy',
                            class: 'product-main__popup-image',
                            size: 'l'
                          -%}
                        </div>
                      </div>
                {%- if carousel -%}
                    </div>
                  </div>
                {%- endif -%}
              {%- endfor -%}

        {%- if carousel -%}
            </div>

            <div class="carousel__pagination{% if product.images.size <= 3 %} carousel__pagination--centered{% else %} carousel carousel__thumbs{%- endif -%}" aria-label="Carousel thumbs" aria-hidden="true">
              {%- assign carousel_thumbs = false -%}

              {%- if product.images.size > 3 -%}
                {%- assign carousel_thumbs = true -%}

                {% comment %} CSS variables start {% endcomment %}
                {%- capture thumbs_variables -%}
                    --slide-width-thumb: 96px;
                    --slide-width-mobile-thumb: 96px;
                {%- endcapture -%}
                {% comment %} CSS variables end {% endcomment %}

              {%- endif -%}

              {%- if carousel_thumbs -%}
                <input class="carousel__timer" type="hidden" name="hidden" value="0">
                <div class="carousel__wrapper" style="{{- thumbs_variables | escape -}}">
              {%- endif -%}

                  {%- for image in product.images -%}
                    {%- assign first = forloop.first -%}
                    {%- assign index = forloop.index -%}

                    {%- if is_focal != blank -%}
                      {%- assign focal = image.coordinates -%}
                    {%- endif -%}

                    {%- if carousel_thumbs -%}
                      <div class="carousel__item">
                        <div class="carousel__inner">
                    {%- endif -%}

                          <span class="carousel__dot carousel__thumb{% if first %} active{%- endif -%}" data-index="{{- index -}}" title="Jump to slide {{ index -}}">
                            <span class="carousel__dot-wrapper">
                              {%- render 'image',
                                image: image,
                                loading: 'lazy',
                                class: 'carousel__dot-image',
                                focal: focal,
                                size: 's'
                              -%}
                            </span>
                          </span>

                    {%- if carousel_thumbs -%}
                        </div>
                      </div>
                    {%- endif -%}
                  {%- endfor -%}
              {%- if carousel_thumbs -%}
                </div>

                <div class="carousel__navigation carousel__navigation-thumbs" aria-label="Carousel navigation thumbs" aria-hidden="true">
                  <span class="carousel__btn prev" title="Prev thumb">
                    Previous thumb
                    {%- render 'icon-arrow-right' -%}
                  </span>
                  <span class="carousel__btn next" title="Next thumb">
                    Next thumb
                    {%- render 'icon-arrow-right' -%}
                  </span>
                </div>
              {%- endif -%}
            </div>
          </div>
        {%- endif -%}

      </div>

      <div class="product-main__info">
          <h1 class="product-main__title">{{- title -}}</h1>

          {%- if description != blank -%}
            <div class="product-main__description">
              {{- description -}}
            </div>
          {%- endif -%}

          {%- if product.variants.size > 1 -%}
            <div class="product-main__variation-label">{{- variation_label -}}</div>
          {%- endif -%}

          {{- product_button -}}

          {%- if message_label != blank -%}
            <div class="product-main__shipping-info">
              <span class="product-main__shipping-label">{{- message_label -}}</span>
            </div>
          {%- endif -%}

          {%- if blocks.size > 0 -%}
            {%- render 'accordion', blocks: blocks, behavior: behavior -%}
          {%- endif -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Product",
    "tag": "section",
    "class": "product-main",
    "templates": ["product"],
    "settings": [
      {
        "type": "header",
        "content": "Basic settings"
      },
      {
        "type": "paragraph",
        "content": "Below you can change the content of section"
      },
      {
        "type": "select",
        "id": "breadcrumbs_label",
        "label": "Breadcrumbs root link",
        "options": [
          {
            "value": "home",
            "label": "Home"
          },
          {
            "value": "collections",
            "label": "Categories"
          },
          {
            "value": "products",
            "label": "All products"
          }
        ],
        "default": "products"
      },
      {
        "type": "text",
        "id": "variation_label",
        "label": "Variations label",
        "default": "Variation"
      },
      {
        "type": "text",
        "id": "message_label",
        "label": "Message label",
        "default": "Free shipping over $50"
      },
      {
        "type": "header",
        "content": "Advanced settings"
      },
      {
        "type": "paragraph",
        "content": "Below you can change the appearance and the components' functionality of the section"
      },
      {
        "type": "select",
        "id": "color_palette",
        "label": "Color palette",
        "options": [
          {
            "value": "one",
            "label": "Color set 1"
          },
          {
            "value": "two",
            "label": "Color set 2"
          }
        ],
        "default": "one"
      },
      {
        "type": "select",
        "id": "color_overlay",
        "label": "Overlay color",
        "options": [
          {
            "value": "dark",
            "label": "Dark"
          },
          {
            "value": "light",
            "label": "Light"
          }
        ],
        "default": "dark"
      },
      {
        "type": "checkbox",
        "id": "show_breadcrumbs",
        "default": true,
        "label": "Show breadcrumbs"
      },
      {
        "type": "header",
        "content": "Carousel settings"
      },
      {
        "type": "number",
        "id": "timer",
        "label": "Auto-rotate timer",
        "min": 0,
        "max": 100,
        "default": 5,
        "info": "Note: Use only positive numbers for pauses between rotating slides. Unit - seconds. Set 0 to turn off auto rotate. Max number = 100"
      },
      {
        "type": "header",
        "content": "Accordion settings"
      },
      {
        "type": "select",
        "id": "behavior",
        "label": "Mode",
        "options": [
          {
            "value": "single",
            "label": "Single"
          },
          {
            "value": "multiple",
            "label": "Multiple"
          }
        ],
        "default": "multiple"
      },
      {
        "type": "header",
        "content": "Desktop settings"
      },
      {
        "type": "select",
        "id": "padding_top",
        "label": "Padding top",
        "options": [
          {
            "value": "none",
            "label": "None"
          },
          {
            "value": "small",
            "label": "Small"
          },
          {
            "value": "medium",
            "label": "Medium"
          },
          {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium"
      },
      {
        "type": "select",
        "id": "padding_bottom",
        "label": "Padding bottom",
        "options": [
          {
            "value": "none",
            "label": "None"
          },
          {
            "value": "small",
            "label": "Small"
          },
          {
            "value": "medium",
            "label": "Medium"
          },
          {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium"
      },
      {
        "type": "header",
        "content": "Mobile settings"
      },
      {
        "type": "select",
        "id": "padding_top_mobile",
        "label": "Padding top",
        "options": [
          {
            "value": "none",
            "label": "None"
          },
          {
            "value": "small",
            "label": "Small"
          },
          {
            "value": "medium",
            "label": "Medium"
          },
          {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium"
      },
      {
        "type": "select",
        "id": "padding_bottom_mobile",
        "label": "Padding bottom",
        "options": [
          {
            "value": "none",
            "label": "None"
          },
          {
            "value": "small",
            "label": "Small"
          },
          {
            "value": "medium",
            "label": "Medium"
          },
          {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium"
      }
    ],
    "max_blocks": 3,
    "blocks":[
      {
        "type": "details",
        "name": "Details",
        "limit": 1,
        "settings": [
          {
            "type": "header",
            "content": "Basic settings"
          },
          {
            "type": "paragraph",
            "content": "Below you can change the content of block"
          },
          {
            "type": "contentEditor",
            "id": "details",
            "label": "Text",
            "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere."
          }
        ]
      },
      {
        "type": "shipping",
        "name": "Shipping",
        "limit": 1,
        "settings": [
          {
            "type": "header",
            "content": "Basic settings"
          },
          {
            "type": "paragraph",
            "content": "Below you can change the content of block"
          },
          {
            "type": "contentEditor",
            "id": "shipping",
            "label": "Text",
            "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere."
          }
        ]
      },
      {
        "type": "returns",
        "name": "Returns",
        "limit": 1,
        "settings": [
          {
            "type": "header",
            "content": "Basic settings"
          },
          {
            "type": "paragraph",
            "content": "Below you can change the content of block"
          },
          {
            "type": "contentEditor",
            "id": "returns",
            "label": "Text",
            "default": "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Duis cursus, mi quis viverra ornare, eros dolor interdum nulla, ut commodo diam libero vitae erat. Aenean faucibus nibh et justo cursus id rutrum lorem imperdiet. Nunc ut sem vitae risus tristique posuere."
          }
        ]
      }
    ],
    "important": true,
    "unique": true
  }
{% endschema %}
