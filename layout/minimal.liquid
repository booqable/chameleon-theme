<!DOCTYPE html>
<html lang="{{ locale }}">
  <head>
    {% comment %} Base metadata {% endcomment %}
    {%- render 'page-base-meta',
        brand_color: branding_color,
        canonical_url: canonical_url,
        page_description: page_description,
        page_title: page_title,
        settings: settings,
        is_local_env: local_env?,
        shop: shop
    -%}

    {% comment %} Resource hints for performance {% endcomment %}
    {%- render 'page-resource-hints' -%}

    {% comment %} Preload fonts {% endcomment %}
    {%- render 'fonts', settings: settings -%}

    {% comment %} Load root styles {% endcomment %}
    {%- render 'root-styles', settings: settings -%}

    {% comment %} Async CSS loading with resource hints {% endcomment %}
    {%- if section_preview -%}
      {%- assign css_files = "critical.css, base.css" | split: ", " -%}
    {%- else -%}
      {%- assign css_files = "critical.css, base.css, header.css" | split: ", " -%}
    {%- endif -%}

    {%- for css_file in css_files -%}
      {%- assign css_url = css_file | asset_url -%}
      <link rel="preload" href="{{ css_url }}" as="style">
      <link rel="stylesheet" href="{{ css_url }}"{% if css_file == 'critical.css' %} data-optimize="critical"{% endif %} media="print" onload="this.media='all'">
    {%- endfor -%}

    <noscript>
      {%- for css_file in css_files -%}
        <link rel="stylesheet" href="{{ css_file | asset_url }}"{% if css_file == 'critical.css' %} data-optimize="critical"{%- endif -%}>
      {%- endfor -%}
    </noscript>

    {%- if section_preview -%}
      {{ options_and_scripts }}
      {{ content_for_styles }}
      {{ sections_assets }}
    {%- else -%}
      {{ content_for_header }}
    {%- endif -%}

    {%- unless section_preview -%}
      {%- render 'page-social-share-meta',
          canonical_url: canonical_url,
          locale: locale,
          image_url: page_meta_image_url,
          image_alt: page_meta_image_alt,
          page_description: page_description,
          page_title: page_title,
          product: product,
          shop: shop
      -%}
    {%- endunless -%}
  </head>
  <body {% if section_preview %} class="preview-app"{%- endif -%}>
    {% unless section_preview %}
      <header class="header" id="header">
        <div style="padding: 16px 0">
          <div class="header__container container">
            <a href="{{ routes.root_url }}" class="header__logo">
              {%- if shop.logo_url != blank -%}
                <img class="header__logo-image" src="{{ shop.logo_url }}" alt="{{ shop.name }}">
              {%- else -%}
                <h2 class="header__logo-text">{{- shop.name -}}</h2>
              {%- endif -%}
            </a>
          </div>
        </div>
      </header>
    {% endunless %}

    <main id="main">
      {{ content_for_layout }}
    </main>

    {{ content_for_body }}

    {%- render 'cookie-notice-variables', settings: settings -%}

    {%- render 'scripts-minimal-layout' -%}
  </body>
</html>
